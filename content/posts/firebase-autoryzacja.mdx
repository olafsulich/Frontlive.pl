---
title: 'Firebase - autoryzacja w 10 minut? To mozliwe!'
category: 'Firebase'
publishedAt: '18-03-2020'
popular: false
excerpt: 'Potrzebujesz autoryzacji uÅ¼ytkownikÃ³w wraz z prostym formularzem logowania i rejestracji. Firebase sprawdzi siÄ™Â idealnie!'
---

## To prostsze niÅ¼ siÄ™ wydaje!

ZaÅ‚Ã³Å¼my, Å¼e robisz stronÄ™ internetowÄ…/aplikacjÄ™ i potrzebujesz autoryzacji uÅ¼ytkownikÃ³w wraz z prostym formularzem logowania i rejestracji. Pierwsza myÅ›l, ktÃ³ra najprawdopodobniej przyszÅ‚a Ci do gÅ‚owy - potrzebujÄ™ serwera i bazy danych, ale w koÅ„cu Ty jesteÅ› frontendowcem, nie backend developerem, czy programistÄ… baz danych. Nie chcesz zagÅ‚Ä™biaÄ‡ siÄ™ w backendowe sprawy, a szybko rozwiÄ…zaÄ‡ problem. WÅ‚aÅ›nie wtedy, pomocÄ… dÅ‚oÅ„ wyciÄ…ga do Ciebie Firebase.

## Co powinieneÅ› wiedzieÄ‡?

Å»eby wyciÄ…gnÄ…Ä‡ z tego artykuÅ‚u 100%, powinieneÅ› swobodnie poruszaÄ‡ siÄ™ po Reactcie.

- MieÄ‡ w maÅ‚ym palcu [HTML & CSS](https://tutorials.comandeer.pl/html5-blog.html).
- ByÄ‡ obeznanym ze standardami [ES6+](https://www.youtube.com/watch?v=eA2YRceiDwk).
- RozumieÄ‡ [Reactowe Hooki](https://reactjs.org/docs/hooks-intro.html)
- PosiadaÄ‡ podstawowÄ… wiedzÄ™ ze [Styled Components](https://styled-components.com/)

> JeÅ›li te zagadnienia sÄ… Ci obce, nie martw siÄ™! Firebase moÅ¼esz rÃ³wniezÅ¼ wykorzystaÄ‡ bez znajomoÅ›ci Reacta.

## Konfiguracja Firebase

Naszym pierwszym krokiem, bÄ™dzie konfiguracja Firebase, kliknij [tutaj](https://console.firebase.google.com/) i utwÃ³rz nowy projekt.

Po utworzeniu projektu, kliknij `Dodaj aplikacjÄ™` i wybierz `Aplikacja sieciowa`.

Po przeklikaniu wymaganych danych, skopiuj **plik konfiguracyjny**. Powinien on wyglÄ…daÄ‡, mniej wiÄ™cej tak:

```js
var config = {
  apiKey: 'AIzaSyDctz47bkEEwdiOMPVnIWWqTTzdtpveAzw',
  authDomain: 'frontlive-1.firebaseapp.com',
  databaseURL: 'https://frontlive-1.firebaseio.com',
  projectId: 'frontlive-1',
  storageBucket: 'frontlive-1.appspot.com',
  messagingSenderId: '1008294462858',
  appId: '1:1008294462858:web:a888d2891e908d183e7473',
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
```

UtwÃ³rz nowy plik w katalogu **src/**, o nazwiÄ™ **firebase.js**.

Dodaj niezbÄ™dne importy i przypisz metodÄ™ **auth()** do consta **auth**, moÅ¼esz go od razu wyeksportowaÄ‡:

```js
import firebase from 'firebase/app';
import 'firebase/auth';
export const auth = firebase.auth();
```

TwÃ³j plik **firebase.js**, po konfiguracji, powinien wyglÄ…daÄ‡ mniej wiÄ™cej tak:

```js
import firebase from 'firebase/app';
import 'firebase/auth';

const firebaseConfig = {
  apiKey: 'AIzaSyDctz47bkEEwdiOMPVnIWWqTTzdtpveAzw',
  authDomain: 'frontlive-1.firebaseapp.com',
  databaseURL: 'https://frontlive-1.firebaseio.com',
  projectId: 'frontlive-1',
  storageBucket: 'frontlive-1.appspot.com',
  messagingSenderId: '1008294462858',
  appId: '1:1008294462858:web:a888d2891e908d183e7473',
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

export const auth = firebase.auth();
```

### Konfiguracja Firebase Auth

Konfiguracja projektu gotowa, wiÄ™c szybko przechodzimy do konfiguracji **firebase auth** i bierzemy siÄ™ do kodzenia!

Przejdz do zakÅ‚adki `Authentication` i wybierz `E-mail/hasÅ‚o`. Teraz wystarczy wÅ‚Ä…czyÄ‡ usÅ‚ugÄ™ i gotowe!

## Komponent Form

Uffâ€¦ konfiguracja gotowa, teraz moÅ¼emy przejÅ›Ä‡ do ciekawszych rzeczy, Przygotujmy komponent Form.js. MoÅ¼esz zrobiÄ‡ to sam w ramach Ä‡wiczeÅ„ lub skorzystaÄ‡ z mojego rozwiÄ…zania:

```js
import React, { useReducer } from 'react';
import styled from 'styled-components';
import { auth } from './Firebase';

const StyledForm = styled.form`
  width: 100%;
  height: 60vh;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  font-family: 'Montserrat';
`;

const StyledWrapper = styled.div`
  width: 100%;
  height: 20rem;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`;

const StyledLabel = styled.label`
  width: 25.5rem;
  text-align: left;
  font-size: 1.2rem;
  padding: 1rem 0;
`;

const StyledInput = styled.input`
  width: 24rem;
  font-size: 1rem;
  background-color: hsla(204, 26%, 96%, 1);
  padding: 15px 20px;
  border: none;
  outline: none;

  :placeholder {
    letter-spacing: 1px;
    color: hsla(0, 0%, 33%, 0.5);
  }
`;

const StyledButtonsWrapper = styled.div`
  width: 24rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
`;

const StyledButton = styled.button`
  color: #fff;
  font-size: 1.1rem;
  background-color: #ffbb4a;
  width: 8rem;
  height: 3rem;
  padding: 0.5rem;
  border: none;
`;

const Form = () => {
  return (
    <StyledForm>
      <StyledWrapper>
        <StyledLabel htmlFor="email-input">Email</StyledLabel>
        <StyledInput
          placeholder="jondoe@gmail.com"
          id="email-input"
          type="email"
          name="email"
          required
        />
      </StyledWrapper>
      <StyledWrapper>
        <StyledLabel htmlFor="password-input">HasÅ‚o</StyledLabel>
        <StyledInput
          placeholder="********"
          type="password"
          name="password"
          id="password-input"
          required
        />
      </StyledWrapper>
      <StyledButtonsWrapper>
        <StyledButton type="submit" name="Zaloguj siÄ™">
          Zaloguj siÄ™
        </StyledButton>
        <StyledButton type="submit" name="Zarejestruj siÄ™">
          Zarejestruj siÄ™
        </StyledButton>
      </StyledButtonsWrapper>
    </StyledForm>
  );
};

export default Form;
```

## ZarzÄ…dzanie statem za pomocÄ… useReducer

Do zarzÄ…dzania statem, postanowiÅ‚em uÅ¼yc hooka [useReducer](https://pl.reactjs.org/docs/hooks-reference.html#usereducer).

Tworzymy hooka, a w nim podajemy dwie wartoÅ›ci, email oraz password:

```js
const [inputsContent, setInputsContent] = useReducer(
  (state, newState) => ({ ...state, ...newState }),
  {
    email: '',
    password: '',
  },
);
```

MoÅ¼emy je od razu [zdestrukturyzowaÄ‡](https://developer.mozilla.org/pl/docs/Web/JavaScript/Referencje/Operatory/Destructuring_assignment):

```js
const { email, password } = inputsContent;
```

## ObsÅ‚uga inputÃ³w i zmiana stanu

Tworzymy funkcjÄ™ **handleInputChange**, do ktÃ³rej przekazujemy event.

Przypisujemy **name** do **value** i gotowe!

```js
const handleInputChange = (e) => {
  setInputsContent({
    [e.target.name]: e.target.value,
  });
};
```

## WysyÅ‚anie danych do Firebase

PrzyszedÅ‚ czas na najwaÅ¼niejszÄ… rzecz, **wysÅ‚anie tych danych** do firebase.

Tworzymy dwie funkcjÄ™ **handleSignIn** i **handleSignUp**, jedna odpowiada za logowanie uÅ¼ytkownika, druga za rejestracjÄ™.

Jak widzisz wykorzystujemy metody z `Firebase`: [signInWithEmailAndPassword](https://firebase.google.com/docs/auth/web/password-auth) i [createUserWithEmailAndPassword](https://firebase.google.com/docs/auth/web/password-auth).

Dodajemy jeszcze najprostszÄ… z moÅ¼liwych obsÅ‚ugÄ™ bÅ‚Ä™dÃ³w i gotowe!

```js
const handleSignIn = (e) => {
  e.preventDefault();
  auth
    .signInWithEmailAndPassword(email, password)
    .catch((error) =>
      alert(`Your email or password is incorrect, please check your data, ${error}`),
    );
};

const handleSignUp = (e) => {
  e.preventDefault();
  auth
    .createUserWithEmailAndPassword(email, password)
    .catch((error) => alert(`Email is already in use, sign in or use other email, ${error}`));
};
```

## Podanie funkcji dla odpowiednich elementÃ³w

Okej, ale jak to wszystko poÅ‚Ä…czyÄ‡ w caÅ‚oÅ›Ä‡?

Nic trudnego, do inputÃ³w dodaj zdarzenie [onChange](https://pl.reactjs.org/docs/forms.html), ktÃ³rego wartoÅ›ciÄ… bÄ™dzie **handleInputChange**.

Do buttonÃ³w dodaj odpowiednie funkcjÄ™ przy zdarzeniu [onClick](https://pl.reactjs.org/docs/handling-events.html): **handleSignIn** i **handleSignUp**.

```js
<StyledForm>
  <StyledWrapper>
    <StyledLabel htmlFor="email-input">Email</StyledLabel>
    <StyledInput
      placeholder="jondoe@gmail.com"
      id="email-input"
      type="email"
      name="email"
      required
      onChange={handleInputChange}
      value={email}
    />
  </StyledWrapper>
  <StyledWrapper>
    <StyledLabel htmlFor="password-input">HasÅ‚o</StyledLabel>
    <StyledInput
      placeholder="********"
      type="password"
      name="password"
      id="password-input"
      required
      onChange={handleInputChange}
      value={password}
    />
  </StyledWrapper>
  <StyledButtonsWrapper>
    <StyledButton type="submit" name="submit" value="1" onClick={handleSignIn}>
      zaloguj siÄ™
    </StyledButton>
    <StyledButton type="submit" name="submit" value="1" onClick={handleSignUp}>
      zarejestruj siÄ™
    </StyledButton>
  </StyledButtonsWrapper>
</StyledForm>
```

## Komponent App

W komponencie App tworzymy hooka [useState](https://pl.reactjs.org/docs/hooks-state.html) z poczÄ…tkowÄ… wartoÅ›ciÄ… `null`

Piszemy potrzebne **Styled Components** i przechodzimy do dalszej pracy.

UÅ¼ywamy tutaj [renderowania warunkowego](https://pl.reactjs.org/docs/conditional-rendering.html), aby wyÅ›wietliÄ‡ poÅ¼Ä…dany komponent, zaleÅ¼nie od tego czy uÅ¼ytkownik jest, czy nie jest zalogowany.

```js
import React, { useState } from 'react';
import styled, { css } from 'styled-components';
import Form from './Form';

const StyledWrapper = styled.section`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`;

const StyledHeading = styled.h1`
  font-size: 3rem;
  font-weight: bold;
  font-family: 'Montserrat';
  text-transform: uppercase;
  color: hsl(153, 91%, 48%, 100%);

  ${({ logout }) =>
    logout &&
    css`
      color: red;
    `};
`;

const App = () => {
  const [currentUser, setCurrentUser] = useState(null);
  return (
    <StyledWrapper>
      {currentUser ? (
        <StyledHeading>Zalogowany</StyledHeading>
      ) : (
        <StyledHeading logout>Niezalogowany</StyledHeading>
      )}
      <Form />
    </StyledWrapper>
  );
};

export default App;
```

## Sprawdzanie czy uÅ¼ytkownik jest zalogowany

Do sprawdzenia, czy nasz uÅ¼ytkownik jest zalogowany, uÅ¼yjemy hooka [useEffect](https://pl.reactjs.org/docs/hooks-effect.html).

Ustawiamy `obserwator` na obiekt **auth**.

Gdy **auth** zmieni swojÄ… wartoÅ›Ä‡, przy logowaniu oraz zarejestrowaniu uÅ¼ytkownika, nasz `obserwator` to wykryje i ustawi wartoÅ›Ä‡ `currentUser` analogicznie do stanu obiektu auth.

Dodatkowo, moÅ¼emy wrzuciÄ‡ naszego `usera` do localStorage, aby po odÅ›wieÅ¼eniu okna przeglÄ…darki, nadal byÅ‚ zalogowany.

Dodajemy [renderowanie warunkowe](https://pl.reactjs.org/docs/conditional-rendering.html), Å¼eby wyÅ›wieltiÄ‡ prawidÅ‚owy stan naszego uÅ¼ytkownika.

```js
import React, { useState, useEffect } from 'react';
import styled, { css } from 'styled-components';
import Form from './Form';
import { auth } from './Firebase';

const StyledWrapper = styled.section`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`;

const StyledHeading = styled.h1`
  font-size: 3rem;
  font-weight: bold;
  font-family: 'Montserrat';
  text-transform: uppercase;
  color: hsl(153, 91%, 48%, 100%);

  ${({ logout }) =>
    logout &&
    css`
      color: red;
    `};
`;

const App = () => {
  const [currentUser, setCurrentUser] = useState(null);

  useEffect(() => {
    auth.onAuthStateChanged((user) => {
      if (user) {
        setCurrentUser(user);
        localStorage.setItem('currentUser', user.uid);
      } else {
        setCurrentUser(null);
        localStorage.removeItem('currentUser');
      }
    });
  }, []);

  return (
    <StyledWrapper>
      {currentUser ? (
        <StyledHeading>Zalogowany</StyledHeading>
      ) : (
        <StyledHeading logout>Niezalogowany</StyledHeading>
      )}
      <Form />
    </StyledWrapper>
  );
};

export default App;
```

## Wylogowanie uÅ¼ytkownika

ZostaÅ‚ nam ostatni punkt na liÅ›cie, wylogowanie uÅ¼ytkownika, buÅ‚ka z masÅ‚em! Bierzemy siÄ™ do pracy.

Tworzymy funkcje `handleSignOut` w komponencie **App**, uÅ¼ywajÄ…c przy tym metody `signOut()` obiektu `auth`;

```js
const handleSignOut = () => auth.signOut();
```

Dodajemy prosty button:

```js
const LogoutButton = styled.button`
  color: hsla(152, 94%, 33%, 1);
  background-color: hsla(204, 26%, 96%, 1);
  padding: 0.6rem 1.8rem;
  font-size: 1.1rem;
  border: none;
```

Przypisujemy mu zdarzenie [onClick](https://pl.reactjs.org/docs/handling-events.html) i gotowe!

```js
...
return (
    <StyledWrapper>
      {currentUser ? (
        <>
          <StyledHeading>Zalogowany</StyledHeading>
          <LogoutButton onClick={handleSignOut}>wyloguj siÄ™</LogoutButton>
        </>
      ) : (
        <StyledHeading logout>Niezalogowany</StyledHeading>
      )}
      <Form />
    </StyledWrapper>
  );
...
```

## Podsumowanie

DziÄ™ki za wytrwanie do koÅ„ca.

Mam nadziejÄ™, Å¼e czegoÅ› siÄ™ nauczyÅ‚eÅ› i Å¼e siÄ™ podobaÅ‚o ğŸ˜„

CaÅ‚y kod znajdziesz [tutaj](https://codesandbox.io/s/naughty-faraday-jvio6), Å¼eby wszystko dziaÅ‚aÅ‚o poprawnie, podmieÅ„ dane pliku konfiguracyjnego w `firebase.js`.

Do usÅ‚yszenia!
